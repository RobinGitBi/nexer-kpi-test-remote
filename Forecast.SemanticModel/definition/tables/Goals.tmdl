table Goals
	lineageTag: 917df58c-2102-492e-b951-c9d4ccdb8b11

	column pk_goals
		dataType: int64
		formatString: 0
		lineageTag: 729f75f4-aef3-4bca-b314-df42308ea067
		summarizeBy: sum
		sourceColumn: pk_goals

		annotation SummarizationSetBy = Automatic

	column GoalId
		dataType: string
		lineageTag: 6058c2ae-b878-487b-a854-2131a36486b7
		summarizeBy: none
		sourceColumn: GoalId

		annotation SummarizationSetBy = Automatic

	column AccountingDate
		dataType: dateTime
		formatString: Long Date
		lineageTag: 20c8d6c4-944a-4c61-b6de-d7de24b90c08
		summarizeBy: none
		sourceColumn: AccountingDate

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column CompanyUnitId
		dataType: string
		lineageTag: e6b9fb9f-5858-4371-bd6f-812257624b9f
		summarizeBy: none
		sourceColumn: CompanyUnitId

		annotation SummarizationSetBy = Automatic

	column Name
		dataType: string
		lineageTag: 7011f98b-6df1-4239-9084-0b66d4153f7c
		summarizeBy: none
		sourceColumn: Name

		annotation SummarizationSetBy = Automatic

	column UHR
		dataType: string
		lineageTag: 39cfce99-0459-4247-87fa-9dc4cc69d4b6
		summarizeBy: none
		sourceColumn: UHR

		annotation SummarizationSetBy = Automatic

	column OH
		dataType: string
		lineageTag: ea2b58ae-73c1-4a9d-9ebb-8edb07e5a617
		summarizeBy: none
		sourceColumn: OH

		annotation SummarizationSetBy = Automatic

	column RevNexer
		dataType: string
		lineageTag: 0a5d7796-4303-4506-9e3c-51d6c4648fd0
		summarizeBy: none
		sourceColumn: RevNexer

		annotation SummarizationSetBy = Automatic

	column EbitNexer
		dataType: string
		lineageTag: d5b66217-40f5-4e4e-8ffa-e8693356bb97
		summarizeBy: none
		sourceColumn: EbitNexer

		annotation SummarizationSetBy = Automatic

	column RevSC
		dataType: string
		lineageTag: 96809e13-875e-42d9-9b37-d8fed511161b
		summarizeBy: none
		sourceColumn: RevSC

		annotation SummarizationSetBy = Automatic

	column GM1SC
		dataType: string
		lineageTag: 0efea210-b23e-4e50-bfde-6dcb14754e20
		summarizeBy: none
		sourceColumn: GM1SC

		annotation SummarizationSetBy = Automatic

	column _increment_timestamp
		dataType: dateTime
		formatString: General Date
		lineageTag: ac1477d9-5d98-4aeb-9dcf-e03128234570
		summarizeBy: none
		sourceColumn: _increment_timestamp

		annotation SummarizationSetBy = Automatic

	column ActualityDate
		dataType: dateTime
		formatString: Long Date
		lineageTag: 0558a673-6ee3-4566-a889-a0aa65454ca4
		summarizeBy: none
		sourceColumn: ActualityDate

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column CompanyId
		dataType: int64
		formatString: 0
		lineageTag: 02082a27-5750-4a21-a4d8-648a5fbccb99
		summarizeBy: none
		sourceColumn: CompanyId

		annotation SummarizationSetBy = Automatic

	column SourceCurrency
		dataType: string
		lineageTag: 1cc99173-8e81-4350-9f06-94c8431ece6b
		summarizeBy: none
		sourceColumn: SourceCurrency

		annotation SummarizationSetBy = Automatic

	column CurrencyId
		dataType: int64
		formatString: 0
		lineageTag: fde3b7ac-8d41-4ece-a1e5-55948da68812
		summarizeBy: count
		sourceColumn: CurrencyId

		annotation SummarizationSetBy = Automatic

	column GlType
		dataType: string
		lineageTag: 7a0cc308-8191-4ea2-b148-767f5e87d39f
		summarizeBy: none
		sourceColumn: GlType

		annotation SummarizationSetBy = Automatic

	column ReportingAmount
		dataType: double
		lineageTag: 2b2bdb52-6074-424d-b16f-a43e39dac3b4
		summarizeBy: sum
		sourceColumn: ReportingAmount

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	partition Goals = m
		mode: import
		source =
				let
				    Source = Databricks.Catalogs("adb-4061987743434543.3.azuredatabricks.net", "/sql/1.0/warehouses/b09a38ac31c647f4", null),
				    prod_gold_Database = Source{[Name="prod_gold",Kind="Database"]}[Data],
				    financereport_Schema = prod_gold_Database{[Name="financereport",Kind="Schema"]}[Data],
				    goals_Table = financereport_Schema{[Name="goals",Kind="Table"]}[Data],
				
				    #"Changed Type" = Table.TransformColumnTypes(goals_Table,{{"AccountingDate", type date}}),
				    // Add new column with first day of the year
				    AddedYearStart = Table.AddColumn(
				        #"Changed Type",
				        "YearStart",
				        each #date(Date.Year([AccountingDate]), 1, 1),
				        type date
				    ),
				    #"Renamed Columns" = Table.RenameColumns(AddedYearStart,{{"YearStart", "ActualityDate"}}),
				    #"Reordered Columns" = Table.ReorderColumns(#"Renamed Columns",{"pk_goals", "GoalId", "AccountingDate", "CompanyUnitId", "ActualityDate", "Revenue", "EBIT", "Name", "UHR", "OH", "RevNexer", "EbitNexer", "RevSC", "GM1SC", "_increment_timestamp"}),
				    #"Inserted Text Before Delimiter" = Table.AddColumn(#"Reordered Columns", "Text Before Delimiter", each Text.BeforeDelimiter([CompanyUnitId], "-"), type text),
				    #"Renamed Columns1" = Table.RenameColumns(#"Inserted Text Before Delimiter",{{"Text Before Delimiter", "CompanyId"}}),
				    #"Reordered Columns1" = Table.ReorderColumns(#"Renamed Columns1",{"pk_goals", "GoalId", "CompanyId", "AccountingDate", "CompanyUnitId", "ActualityDate", "Revenue", "EBIT", "Name", "UHR", "OH", "RevNexer", "EbitNexer", "RevSC", "GM1SC", "_increment_timestamp"}),
				    #"Changed Type1" = Table.TransformColumnTypes(#"Reordered Columns1",{{"CompanyId", Int64.Type}}),
				    #"Merged Queries" = Table.NestedJoin(#"Changed Type1", {"CompanyId"}, Company, {"CompanyId"}, "Company", JoinKind.LeftOuter),
				    #"Expanded Company" = Table.ExpandTableColumn(#"Merged Queries", "Company", {"SourceCurrency"}, {"SourceCurrency"}),
				    #"Merged Queries1" = Table.NestedJoin(#"Expanded Company", {"SourceCurrency"}, #"Source Currency", {"SourceCurrency"}, "Source Currency", JoinKind.LeftOuter),
				    #"Expanded Source Currency" = Table.ExpandTableColumn(#"Merged Queries1", "Source Currency", {"CurrencyId"}, {"CurrencyId"}),
				    #"Filtered Rows" = Table.SelectRows(#"Expanded Source Currency", each true),
				    #"Changed Type2" = Table.TransformColumnTypes(#"Filtered Rows",{{"Revenue", type number}, {"EBIT", type number}}),
				    #"Unpivoted Columns" = Table.UnpivotOtherColumns(#"Changed Type2", {"pk_goals", "GoalId", "CompanyId", "AccountingDate", "CompanyUnitId", "ActualityDate", "Name", "UHR", "OH", "RevNexer", "EbitNexer", "RevSC", "GM1SC", "_increment_timestamp", "SourceCurrency", "CurrencyId"}, "Attribute", "Value"),
				    #"Renamed Columns2" = Table.RenameColumns(#"Unpivoted Columns",{{"Attribute", "GlType"}}),
				    #"Uppercased Text" = Table.TransformColumns(#"Renamed Columns2",{{"GlType", Text.Upper, type text}}),
				    #"Renamed Columns3" = Table.RenameColumns(#"Uppercased Text",{{"Value", "ReportingAmount"}})
				in
				    #"Renamed Columns3"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

